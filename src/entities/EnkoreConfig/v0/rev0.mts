import type {EnkoreAutogeneratedFile} from "#~export/__aggregatedExports.mts"
import type {AllEnkoreTargets} from "#~src/AllEnkoreTargets.mts"

import type {TargetIdentifier} from "@enkore/primitives"
import type {TargetIdentifierToEntityName} from "#~src/TargetIdentifierToEntityName.mts"

import type {ValidToolchainCombinations} from "@enkore-types/toolchains"

type Map = {
	[K in TargetIdentifier]: Extract<AllEnkoreTargets, {
		entityKind: TargetIdentifierToEntityName<K>
	}>
}

type Targets = {
	[K in TargetIdentifier]: {
		name: K
		options: Map[K]
		_toolchain?: ValidToolchainCombinations
	}
}

export type Definition = {
	target: Targets[keyof Targets]

	autogeneratedFiles?: EnkoreAutogeneratedFile[]

	buildConstants?: Record<string, string>
}

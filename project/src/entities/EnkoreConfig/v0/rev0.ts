import type {EnkoreAutogeneratedFile} from "#~export/__aggregatedExports.ts"
import type {AllEnkoreTargetOptions} from "#~src/AllEnkoreTargetOptions.ts"

import type {TargetIdentifier, ToolchainSpecifier} from "@anio-software/enkore-private.primitives"
import type {TargetIdentifierToEntityName} from "#~src/TargetIdentifierToEntityName.ts"

type Map = {
	[K in TargetIdentifier]: Extract<AllEnkoreTargetOptions, {
		entityKind: TargetIdentifierToEntityName<K>
	}>
}

type Targets = {
	[K in TargetIdentifier]: {
		name: K
		options: Map[K]
		_toolchain?: ToolchainSpecifier
	}
}

export type Definition = {
	target: Targets[keyof Targets]

	autogeneratedFiles?: EnkoreAutogeneratedFile[]

	// BEWARE THIS PROPERTY IS REFERENCED IN "EnkoreJSRuntimeProject" !!!
	buildConstants?: Record<string, string>
}
